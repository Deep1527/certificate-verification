function doGet(e) {
  var reg = e.parameter.reg;
  if (!reg) {
    return ContentService.createTextOutput("‚ùó Please provide registration number as ?reg=Mice001");
  }

  var ss = SpreadsheetApp.openById("1sr8an4xlg1Bp3xkPflmyq3jfAVjSH2ZjMnXnXuGnJpw"); // ‚úÖ Correct: Using ID
  var sheet = ss.getSheetByName("CertificateData");
  var data = sheet.getDataRange().getValues();

  for (var i = 1; i < data.length; i++) {
    if (data[i][0].toString().toLowerCase() === reg.toLowerCase()) {
      var name = data[i][1];
      var course = data[i][2];
      var marks = data[i][3];
      var result = data[i][4];
      var startDate = data[i][5];
      var endDate = data[i][6];

      var response = `
‚úÖ Certificate Verified

üë§ Name: ${name}
üÜî Registration No: ${data[i][0]}
üìò Course: ${course}
üìÖ Start Date: ${startDate}
üìÖ End Date: ${endDate}
üìä Marks: ${marks}
üéØ Result: ${result}

‚úÖ Verified by Mahakaal Institute
`;

      return ContentService.createTextOutput(response);
    }
  }

  return ContentService.createTextOutput("‚ùå Invalid Registration Number or Not Found.");
}